\input{../header.tex}

\begin{document}
  \section{Analytische Betrachtung}
  Der Hamilton-Operator des Isingmodells mit $N$ Spins ist
  \begin{equation}
	H=-J\sum\limits_{\left<i, j\right>}S_i S_j -h\sum\limits_{i=1}^N S_i, \label{eq:hamiltonian}
  \end{equation}
  wobei $\sum\limits_{\left<i, j\right>}$ die Summe über nächste Nachbarn des Spins $i$ ist, ohne Paare doppelt zu zählen. \\
  Analytisch lässt sich das eindimensionale Isingmodell über eine Transfermatrix-Methode betrachten. Wir betrachten dazu den Fall periodischer Randbedingungen, d.h. $S_N+1=S_1$. Dann lässt sich der Hamitonoperator Gl.~\eqref{eq:hamiltonian} als
  \begin{equation*}
	H=-J\sum\limits_{i=1}^N S_i S_{i+1}-h\sum\limits_{i=1}^N \frac{S_i+S_{i+1}}{2}
  \end{equation*}
  schreiben. \\
  Um nun Größen wie die thermodynamischen Potentiale zu erhalten muss man die Zustandssumme $Q_N=\Tr\left(e^{-\beta H}\right)$ bilden, d.h.
  \begin{equation*}
	Q_N=\sum\limits_{S_1=\pm 1}\sum\limits_{S_2=\pm 1}\dots\sum\limits_{S_N=\pm 1}\prod\limits_{i=1}^N \exp\left(\beta J S_i S_{i+1}+\beta h \frac{S_i+S_{i+1}}{2}\right)
  \end{equation*}
  Da $S_i=\pm 1$ können wir das Produkt von Exponentialfunktionen als Produkt von Matrixelementen der Transfermatrix
  \begin{equation*}
		V=\begin{pmatrix}
			e^{\beta\left(J+h\right)} & e^{-\beta J} \\
			e^{-\beta J} & e^{\beta\left(J-h\right)} \\
		\end{pmatrix}
  \end{equation*}
  schreiben und zwar als
  \begin{align*}
				Q_N&=\sum\limits_{S_1=\pm 1}\sum\limits_{S_2=\pm 1}\dots\sum\limits_{S_N=\pm 1}V_{S_1 S_2} V_{S_2 S_3} \dots V_{S_{N-1}S_n} V_{S_N S_1} \\
							&=\sum\limits_{S_1=\pm 1}{\left(V^N\right)}_{S_1 S_1}=\Tr\left(V^N\right)
  \end{align*}
		Nach dem Satz von Perron und Frobenius ist der größte (betragsmäßig) Eigenwert $\lambda_+$ einer solchen Matrix mit nicht-negativen Einträgen positiv und nicht entartet. Eine Rechnung zeigt, dass die beiden Eigenwerte der Transfermatrix
		\begin{equation}
				\lambda_{\pm}=e^{\beta J}\cosh\left(\beta h\right)\pm\sqrt{e^{2\beta J}\sinh^2\left(\beta h\right)+e^{-2\beta J}}\label{eq:eigenwert}
		\end{equation}
		sind und die Zustandssumme wird zu (Transformation in das Eignesystem von $V$, Diagonalisierung)
		\begin{equation*}
				Q_N=\lambda_+^N+\lambda_-^N=\lambda_+^N\left(1+\frac{\lambda_-^N}{\lambda_+^N}\right)
		\end{equation*}
		Wir betrachten den thermodynamischen Limes großer Teilchenzahlen. Auf grund der Dominaz des größeren Eigenwertes erhält man die Zustandssumme
		\begin{equation}
				Q_N=\lambda_+^N\label{eq:zustandssumme}
		\end{equation}
		tir interessieren uns nun für die innere Energie $U=\left<H\right>=-\frac{\partial}{\partial\beta}\ln Q_N$, die freie Energie $F=-\frac{1}{\beta}\ln Q_N$ und die Magnetisierung $M=\frac{1}{N}\sum\limits_{i=1}^N\left<S_i\right>=-{\left.\frac{\partial\left(F/N\right)}{\partial h}\right|}_T$. Diese Größen sollen nun im einzelnen berechnet werden.

		\subsection{Freie Energie}
		\begin{align}
    F&=-\frac{1}{\beta}\ln Q_N\overset{\mathrm{Gl.~\eqref{eq:zustandssumme}}}{=}-\frac{N}{\beta}\ln\lambda_+ \nonumber\\
				\overset{\mathrm{Gl.~\eqref{eq:eigenwert}}}{\Leftrightarrow}\frac{F}{N}&=-\frac{1}{\beta}\ln\left(e^{\beta J}\cosh\left(\beta h\right)+\sqrt{e^{2\beta J}\sinh^2\left(\beta h\right)+e^{-4\beta J}}\right)\label{eq:freieenergie}
		\end{align}

		\subsection{Magnetisierung}
		\begin{equation}
				M=-{\left.\frac{\partial\left(F/N\right)}{\partial h}\right|}_T\overset{\mathrm{Gl.~\eqref{eq:freieenergie}}}{=}\frac{\sinh\left(\beta h\right)}{\sqrt{\sinh^2\left(\beta h\right)+e^{-4\beta J}}}\label{eq:magnetisierung}
		\end{equation}
		Uns wird auch der Fall ohne interne Kopplung ($J=0$) interessieren. In diesem Fall ist
		\begin{equation}
				M=\tanh\left(\beta h\right)\label{eq:magnetisierungJ0}
		\end{equation}

		\subsection{Innere Energie}
		\begin{align}
				U&=\left<H\right>=-\frac{\partial}{\partial\beta}\ln Q_N \nonumber\\
				\overset{\mathrm{Gl.~\eqref{eq:zustandssumme}}}{\Leftrightarrow}\frac{U}{N}&=-\frac{\partial}{\partial\beta}\ln\lambda_+=-\frac{1}{\lambda_+}\frac{\partial\lambda_+}{\partial\beta}\label{eq:energy}
		\end{align}
		Die Ableitung des Eigenwertes ist
		\begin{equation*}
				\frac{\partial\lambda_+}{\partial\beta}=\frac{he^{2\beta J}\sinh\left(\beta h\right)\cosh\left(\beta h\right)-J e^{-2\beta J}}{\sqrt{e^{2\beta J}\sinh^2\left(\beta h\right)+e^{-2\beta J}}}+h e^{\beta J}\sinh\left(\beta h\right)+J e^{\beta J}\cosh\left(\beta h\right)
		\end{equation*}
		Damit haben wir einen analytischen (aber sehr langen) Ausdruck für die innere Energie gewonnen. Es sollen die Grenzfälle $h=0$ und $J=0$ betrachtet werden.\\[0.5mm]
		\textbf{1. Fall $h=0$:}
  \begin{align}
				{\left.\lambda_+\right|}_{h=0}&=2\cosh\left(\beta J\right)\nonumber\\
				{\left.\frac{\partial\lambda_+}{\partial\beta}\right|}_{h=0}&=2J\sinh\left(\beta J\right)\nonumber\\
				\Rightarrow {\left.\frac{U}{N}\right|}_{J=0}&=J\tanh\left(\beta J\right)\label{eq:energyh0}
		\end{align}
		\textbf{2. Fall $J=0$:}
		\begin{align}
				{\left.\lambda_+\right|}_{J=0}&=2\cosh\left(\beta h\right)\nonumber\\
				{\left.\frac{\partial\lambda_+}{\partial\beta}\right|}_{h=0}&=2h\sinh\left(\beta h\right)\nonumber\\
				\Rightarrow {\left.\frac{U}{N}\right|}_{J=0}&=h\tanh\left(\beta h\right)\label{eq:energyJ0}
		\end{align}


		\section{Metropolis Monte-Carlo Simulation}
		Zur Simulation des Isingmodells wird zunächst eine Spin-Konfiguration. Für ein kaltes System sind alle Spins parallel. Dies entspricht einer spontanen Magnetisierung, die auch beim der simulierten Abkühlung eines heißen Systems beobachtet wird. Dies entspricht einer spontanen Magnetisierung, die auch beim der simulierten Abkühlung eines heißen Systems beobachtet wird. Für ein heißes System zeigt jeder Spin zufällig entweder nach oben oder unten, da die Spins auf Grund der hohen Temperatur auch im energetisch ungünstigen Zustand der Antiparallelität sein können. \\
		Nun wird eine bestimmte Anzahl (hier balance steps genannt) durchgeführt, damit sich das System (hoffentlich, bei genügend hoher Anzahl solcher Schritte) in den energetisch günstigen Gleichgewichtszustand für die aktuelle Situation ($h, J, T$) einstellt. Jeder dieser Schritte ist ein voller Monte-Carlo Schritt, d.h.\ jeder Spin muss die Möglichkeit haben einmal geflippt zu werden. Anschließend können die Systemparameter (vorsichtig, d.h.\ wenig) geändert werden und es muss erneut auf den Gleichgewichtszustand gewartet werden.\\
		Zu beachten ist noch das diese Simulation keiner zeitlichen Dynamik entspricht (der Hamiltonoperator Gl.~\eqref{eq:hamiltonian} besitzt gar keine Zeitentwicklung) sondern viel mehr einfach viele Zustände im Phasenraum probiert werden, um einen möglichst günstigen zu finden.\\
		Das Flippen eines Spins funktioniert wird durch Alg.~\ref{alg:metropolis} beschrieben. Es wird ein zufälliger Spin ausgewählt. Wenn die Energie des Systems durch das Umdrehen des Spins kleiner wird, wird der Spin auf jedenfall umgedreht und die Magnetisierung/Energie angepasst. Ansonsten wird der Spin nur mit einer gewissen Wahrscheinlichkeit geflippt (s.u.).\\
		Wird der Spin $j$ geflippt so ändert sich die Energie im System um
		\begin{equation*}
				\Delta E=2 J \left(S_{j-1}S_j+S_j S_{j+1}\right) + 2 h S_j
		\end{equation*}
		und die Magnetisierung um
		\begin{equation*}
				\Delta M = -2S_j,
		\end{equation*}
		dabei ist $S_j$ der Wert des Spins vor dem Flip. \\
		Die Wahrscheinlichkeit für den Flip ist dann
		\begin{equation*}
				p=\exp\left(-\beta\Delta E\right).
		\end{equation*}
		Die Werte für $\Delta E$ und $p$ kann man tabellieren, da es genau $8$ mögliche Konfigurationen von einem Spin und seinen zwei Nachbarn gibt. Die Tabellen müssen bei Änderungen von $J$, $h$ oder $T$ eventuell neu berechnet werden. Allerdings kann die Simulation dadurch wesentlich beschleunigt werden, da es viele Schritte (immer wenn man das Gleichgewicht sich einstellen lässt) gibt, in denen diese Parameter konstant sind.
		\begin{algorithm}[ht]
				\caption{Metropolis Algorithmus für die Monte Carlo Simulation des 1D-Isingmodells}\label{alg:metropolis}
				\begin{algorithmic}[1]
						\Procedure{MetropolisIsing}{$\lbrace S_1\dots S_N\rbrace, E, M$}
								\State $j \gets \mathrm{randomInt}\left(1, N\right)$
								\State $\Delta E \gets \mathrm{flipEnergy}\left(S_{j-1}, S_j, S_{j+1}\right)$
								\If{$\Delta E < 0$}
										\State $E \gets E+\Delta E$
										\State $M \gets M-2\cdot S_j$
								  \State $S_j \gets -S_j$
								\Else
								  \State $p \gets \mathrm{flipProbability}\left(S_{j-1}, S_j, S_{j+1}\right)$
										\State $x \gets \mathrm{randomReal}\left(0, 1\right)$
										\If{$x<p$}
										  \State $E \gets E+\Delta E$
  										\State $M \gets M-2\cdot S_j$
		  						  \State $S_j \gets -S_j$
										\EndIf
								\EndIf
						\EndProcedure{}
				\end{algorithmic}
		\end{algorithm}
		\FloatBarrier{}

		\section{Vergleich von Theorie und Simulation}
		Es wird ein kleines System $128$ und ein großes System $8192$ Spins simuliert und mit der Theorie verglichen.
		\subsection{$U\left(T\right)$ bei $h=0$}
		Um die Konsistenz der Simulation zu prüfen wurde das System einmal beim Abkühlen und einmal beim Erhitzen simuliert. Die Ergebnisse passen gut zur Theoriekurve Gl. \eqref{eq:energyh0}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_cooling_J.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_cooling_J.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_heating_J.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_heating_J.pdf}
		\end{figure}
		\FloatBarrier{}

		\subsection{$U\left(T\right)$ bei $J=0$}
		Um die Konsistenz der Simulation zu prüfen wurde das System einmal beim Abkühlen und einmal beim Erhitzen simuliert. Die Ergebnisse passen gut zur Theoriekurve Gl.~\eqref{eq:energyJ0}.
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_cooling_h.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_cooling_h.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_heating_h.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_heating_h.pdf}
		\end{figure}
		\FloatBarrier{}

		\subsection{$U\left(T\right)$ bei $J\neq 0$ und $h\neq 0$}
		Die Theoriekurve ergbibt sich hier aus den langen Formel~\eqref{eq:energy}. Sie passt allerdings nicht so gut zur Simulation (vor allem der Anstieg ganz links).
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_cooling.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_cooling.pdf}
		\end{figure}
		\FloatBarrier{}

		\subsection{$M\left(h\right)$ bei verschiedenen $T$}
		Die Theoriekurve~\eqref{eq:magnetisierungJ0} passt sehr gut zu der Simulation.
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_mag_T.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_mag_T.pdf}
		\end{figure}
		\FloatBarrier{}

		\subsection{$M\left(h\right)$ bei verschiedenen $J$}
		Die Theoriekurve~\eqref{eq:magnetisierung} passt sehr gut zu der Simulation.
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{few_mag_J.pdf}
		\end{figure}
		\begin{figure}[ht]
				\centering
				\includegraphics[scale=0.47]{many_mag_J.pdf}
		\end{figure}
		\FloatBarrier{}
\end{document}
